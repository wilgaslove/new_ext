"use strict";(self.webpackChunkoauth2_manage_tokens=self.webpackChunkoauth2_manage_tokens||[]).push([[7623],{17623:(e,n,l)=>{l.r(n),l.d(n,{FileUploader:()=>ve,KeyValueEditor:()=>An});var i=l(7560),t=l(40540),o=l(25892),a=l.n(o),s=l(62932),r=l(50916),d=l(98283),c=l(64382),u=l(22723),p=l.n(u),h=l(53723),b=l.n(h),g=l(80519),v=l(52322);const m=a().div.withConfig({displayName:"key-value-row-actions__KeyValueRowActionsContainer",componentId:"sc-d48k5r-0"})(["position:relative;display:flex;width:40px;justify-content:flex-end;align-items:center;padding-right:4px;border-left:var(--border-width-default) var(--border-style-solid) var(--border-color-default);border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);background-color:",";"],(e=>e.disabled?"var(--background-color-secondary);":"inherit")),f=a()(g.Z).withConfig({displayName:"key-value-row-actions__StyledCheckbox",componentId:"sc-d48k5r-1"})(["> span > div{height:16px;width:16px;background-color:",";}&.disabled{opacity:0.4;}"],(e=>e.isChecked?"dark"===e.theme.name?"#ffffff":"#262626":"inherit"));function y(e){return(0,v.jsx)(m,{disabled:e.disabled,children:e.shouldShowCheckbox&&(0,v.jsx)(f,{className:b()({disabled:e.isCheckboxDisabled}),isChecked:e.isRowEnabled,onChange:e.onToggleEnabledState,isDisabled:e.isCheckboxDisabled})})}const x=["content"],C=a().div.withConfig({displayName:"key-value-column__KeyValueColumnContainer",componentId:"sc-1d89p7f-0"})(["display:flex;flex:",";overflow-y:visible;min-width:0;margin:var(--spacing-zero);position:relative;height:32px;box-sizing:border-box;border-right:",";background-color:",";.key-value-cell{color:",";}"],(e=>e.isLastColumn?`0 1 ${e.columnWidth}%`:`0 0 ${e.columnWidth}%`),(({isLastColumn:e})=>e?"unset":"var(--border-width-default) var(--border-style-solid)\n    var(--border-color-default)"),(e=>e.isNonEditable?"var(--background-color-secondary)":"inherit"),(e=>e.isNonEditable?"var(--content-color-secondary)":"inherit"));function w(e){let{content:n}=e,l=(0,d.Z)(e,x);return(0,v.jsx)(C,(0,i.Z)({},l,{children:n}))}const k=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"";function j(e,n){if(typeof e!=typeof n)return!1;const l=typeof e;return["string","number","boolean","undefined"].includes(typeof e)?e===n:Array.isArray(e)&&Array.isArray(n)?e.length===n.length&&e.every(((e,l)=>j(e,n[l]))):"object"===l&&(null===e&&null===n||null!==e&&null!==n&&!Array.isArray(e)&&!Array.isArray(n)&&Object.keys(e).length===Object.keys(n).length&&Object.keys(e).every((l=>j(e[l],n[l]))))}var V=l(59713);const S=a().div.withConfig({displayName:"delete-row__IconContainer",componentId:"sc-2wjj4i-0"})(["align-items:center;height:24px;display:inline-flex;padding:0 var(--spacing-s);border-radius:var(--border-radius-default);&:hover{background-color:var(--highlight-background-color-primary);cursor:pointer;}"]);function T({onClick:e}){return(0,v.jsx)(S,{className:"delete-button",onClick:e,role:"button","aria-label":"delete-row",children:(0,v.jsx)(V.Z,{})})}function E(e,n,l){let i,t,o,a,s,r,d=0,c=!1,u=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");if(n=+n||0,l&&function(e){const n=typeof e;return null!=e&&("object"===n||"function"===n)}(l)){if(c=!(null==l||!l.leading),u="maxWait"in l,u){const e=(null==l?void 0:l.maxWait)||0;o=Math.max(+e,n)}p="trailing"in l?!(null==l||!l.trailing):p}function h(n){const l=i,o=t;return i=t=void 0,d=n,a=e.apply(o,l),a}function b(e,n){return setTimeout(e,n)}function g(e){const l=e-r;return void 0===r||l>=n||l<0||u&&e-d>=o}function v(){const e=Date.now();if(g(e))return m(e);s=b(v,function(e){const l=e-d,i=n-(e-r);return u?Math.min(i,o-l):i}(e))}function m(e){return s=void 0,p&&i?h(e):(i=t=void 0,a)}function f(...e){const l=Date.now(),o=g(l);if(i=e,t=this,r=l,o){if(void 0===s)return function(e){return d=e,s=b(v,n),c?h(e):a}(r);if(u)return s=b(v,n),h(r)}return void 0===s&&(s=b(v,n)),a}return f.cancel=function(){void 0!==s&&clearTimeout(s),d=0,i=r=t=s=void 0},f.flush=function(){return void 0===s?a:m(Date.now())},f.pending=function(){return void 0!==s},f}const _=["indicators","isDuplicated"],R=a().textarea.withConfig({displayName:"editable-cell__StyledTextArea",componentId:"sc-2rjqth-0"})(["width:100%;color:var(--content-color-primary);font-size:inherit;font-family:inherit;outline:transparent;resize:none;font-weight:inherit;background:var(--background-color-primary);margin:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-zero) var(--spacing-xs) var(--spacing-xs);border:var(--border-width-default) var(--border-style-solid) var(--border-color-default);z-index:1;",""],(({isDuplicated:e})=>e&&"padding-right: var(--spacing-l)")),A=a().div.withConfig({displayName:"editable-cell__StyledWrapper",componentId:"sc-2rjqth-1"})(["display:flex;align-items:flex-start;max-height:var(--size-m);height:100%;width:100%;"]),D=E(((e,n,l)=>{var i,t;const o=null!=(i=(null==e?void 0:e.scrollHeight)/(null==e||null==(t=e.parentNode)?void 0:t.clientHeight))?i:0;o!==n&&l(Math.ceil(o))}),100);function N(e){let{indicators:n,isDuplicated:l}=e,i=(0,d.Z)(e,_);const o=(0,t.useRef)(null),[a,s]=(0,t.useState)(1);return(0,t.useEffect)((()=>(setTimeout((()=>{if(o.current){const e=o.current.value.length;o.current.selectionStart=e,o.current.selectionEnd=e,o.current.scrollTop=o.current.scrollHeight}})),D(o.current,a,s),()=>{D.cancel()})),[a]),(0,v.jsxs)(A,{children:[(0,v.jsx)(R,{isDuplicated:l,role:"cell","aria-label":`${i.type} input`,ref:o,value:i.value,rows:a,onChange:e=>{i.onChange(e.target.value),D(o.current,a,s)},autoFocus:i.shouldFocusOnMount,placeholder:i.placeholder||"",readOnly:i.readOnly,onBlur:i.onBlur,onKeyDown:e=>{i.preventEnter&&13===e.keyCode&&e.preventDefault()}}),n]})}function W(e){return"string"==typeof e?e:e?e&&e.toString?String(e):Object.prototype.toString.call(e):""}function Z(e,n={}){return e?("string"!=typeof e&&(e=W(e)),e.split("\n").map(((e,l)=>(0,v.jsx)("span",{children:M(e,n)},l)))):e}function F(e,n={}){return e?("string"!=typeof e&&(e=W(e)),M(e.split("\n")[0],n)):e}function M(e,n={}){const l=n.maxLength||100;return e?("string"!=typeof e&&(e=W(e)),e.length<=l?e:e.slice(0,l+1)):""}const I=a().div.withConfig({displayName:"key-value-cell__KeyValueCellContainer",componentId:"sc-84c69n-0"})(["width:100%;padding:var(--spacing-zero) var(--spacing-xs) var(--spacing-zero) 9px;align-items:center;cursor:text;font-size:var(--text-size-m);user-select:none;display:flex;height:100%;box-sizing:border-box;justify-content:space-between;color:var(--content-color-primary);",""],(({isDuplicated:e})=>e&&"padding-right: var(--spacing-xl)")),P=a().div.withConfig({displayName:"key-value-cell__KeyValueCellTextContainer",componentId:"sc-84c69n-1"})(["white-space:pre;overflow:hidden;text-overflow:ellipsis;&:empty:not(:focus):before{content:attr(data-placeholder);color:var(--content-color-tertiary);}"]);function z(e){const n=(0,t.useRef)(null),{value:l,placeholder:i,onBlur:o,preventEnter:a,onFocus:s,type:r,currentWidth:d,actions:c,indicators:u,isDuplicated:p}=e,h=!a,b=(0,t.useCallback)((()=>{null==s||s()}),[s]),g=!l&&i,m=g?`${r} empty cell`:`${r} cell`;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(I,{onBlur:o,onClick:b,ref:n,tabIndex:"0",onFocus:b,isDuplicated:p,children:(0,v.jsx)(P,{role:"cell","aria-label":m,"data-placeholder":g?i:null,children:h?F(l,{maxLength:Math.ceil(2*d)}):Z(l,{maxLength:Math.ceil(2*d)})})}),u,c]})}I.displayName="KeyValueCellContainer";const O=[{value:"text",label:"Text"},{value:"file",label:"File"}],H="secret",B="default",K=a().div.withConfig({displayName:"masked-cell__MaskedInputContainer",componentId:"sc-1u9ft8o-0"})(["padding-inline-start:var(--spacing-xs);display:flex;flex:1;input{border:var(--border-width-default) var(--border-style-solid) transparent;color:var(--content-color-primary);width:100%;font-size:var(--text-size-m);line-height:var(--line-height-m);font-family:var(--text-family-default);height:var(--controls-size-default);box-sizing:border-box;background-color:transparent;padding:var(--spacing-zero);overflow:hidden;text-overflow:ellipsis;display:block;padding-left:var(--spacing-xs);&:hover,&:focus,&:active{outline:none;}",";}"],(({isFocused:e})=>e&&"\n        border: var(--border-width-default) var(--border-style-solid) var(--border-color-default);\n        background: var(--background-color-primary);\n        height: var(--size-s);\n        padding-left: var(--spacing-xs);\n        margin-top: var(--spacing-xs);\n        margin-right: var(--spacing-s);\n    "));function L(e){const{value:n,isEditable:l,onBlur:i,onChange:t,onFocus:o,type:a}=e,s=`${a} masked cell`;return(0,v.jsx)(K,{isFocused:Boolean(l),onBlur:i,onClick:o,onFocus:o,children:(0,v.jsx)("input",{role:"cell","aria-label":s,value:n||"",spellCheck:!1,type:"password",onChange:e=>{t(e.currentTarget.value)}},"text")})}var $=l(16913),U=l(81397),q=l(79233);const X=["hidden","value","isEditable","currentWidth","readOnly","shouldFocusOnMount","onBlur","onChange","onFocus","actions","editorType","maskState","enableVariableSuggestions","placeholder","isDuplicated"],Y=a()($.Z).withConfig({displayName:"key-value-cell-editor__StyledWarningIcon",componentId:"sc-s9e2t4-0"})(["position:absolute;align-self:center;right:var(--spacing-s);z-index:10;"]);function G(e){const{hidden:n,value:l,isEditable:t,currentWidth:o,readOnly:a,shouldFocusOnMount:s,onBlur:r,onChange:c,onFocus:u,actions:p,editorType:h,maskState:b,enableVariableSuggestions:g,placeholder:m,isDuplicated:f}=e,y=(0,d.Z)(e,X),x={readOnly:a,shouldFocusOnMount:s,onBlur:r,onChange:c},C=e=>{null==c||c(y.type,e)},w=(0,q.usePostmanInputFeatureFlag)();if(n)return null;if(g&&w){let n=!l&&m?`${y.type} empty cell`:`${y.type} cell`;return t&&(n=`${y.type} input`),(0,v.jsx)(q.KVEditorInput,{value:l||"",onChange:C,suggestions:[],placeholder:"key"===y.type?"Key":"Value",ariaLabel:n,onFocus:u,onBlur:r,shouldFocusOnMount:s,actions:p,indicators:e.indicators,isEditable:!x.readOnly})}return h===H&&b.isMasked?(0,v.jsx)(L,(0,i.Z)({onChange:C,onFocus:u,onBlur:r,isEditable:t,value:l,placeholder:m},y)):(0,v.jsxs)(v.Fragment,{children:[t?(0,v.jsx)(N,(0,i.Z)({},x,{onChange:C,onFocus:u,value:l,placeholder:m,isDuplicated:f},y)):(0,v.jsx)(z,(0,i.Z)({},y,{value:l,onFocus:u,actions:p,onChange:C,placeholder:m,currentWidth:o,isDuplicated:f})),f&&(0,v.jsx)(U.Z,{content:"This variable has been overwritten by a duplicate key.",placement:"bottom",children:(0,v.jsx)(Y,{color:"content-color-warning",className:"duplicate-warning-icon"})})]})}var J=l(74962),Q=l(63622),ee=l(84591);const ne=a().div.withConfig({displayName:"key-value-cell-info__InfoIconContainer",componentId:"sc-ukarc6-0"})(["position:absolute;right:var(--spacing-m);display:flex;height:100%;align-items:center;cursor:default;z-index:1;background:transparent !important;"]),le=({infoTitle:e,info:n})=>(0,v.jsxs)(v.Fragment,{children:[e&&(0,v.jsx)(J.Z,{type:"h3",styleAs:"h4",text:e}),n&&(0,v.jsx)(Q.ZP,{type:"small",color:"content-color-primary",children:n})]}),ie=e=>{const{info:n,infoTitle:l,placement:t}=e;return n||l?(0,v.jsx)(ne,{children:(0,v.jsx)(U.Z,{content:(0,v.jsx)(le,(0,i.Z)({},e)),placement:t,children:(0,v.jsx)(ee.Z,{})})}):null},te=a()(c.Z).withConfig({displayName:"key-value-dropdown__StyledSelect",componentId:"sc-8xelg1-0"})(["margin:var(--spacing-xs);min-width:80px;"]);function oe(e){const{hidden:n,options:l,defaultOption:i,onChange:o}=e,[a,s]=(0,t.useState)(i),[r,d]=(0,t.useState)(!1);return!r&&n?null:(0,v.jsx)(te,{viaPortal:!0,className:"single-type-select","aria-label":"KV Type Select",triggerWidth:"auto",triggerSize:"small",triggerType:"tertiary",menuMinWidth:100,menuMaxWidth:165,isSearchable:!1,isClearable:!1,options:l,value:a,onOpen:()=>d(!0),onClose:()=>d(!1),onChange:e=>{s(e),null==o||o(e)}})}var ae=l(58560),se=l(69568),re=l(40430),de=l(35736);const ce=["value","onReset","id","label","name","multiple","isDisabled","loading","error","accept","autoFocus","onChange"],ue="Couldn't upload file",pe=a().input.attrs({type:"file"}).withConfig({displayName:"file-uploader__StyledInputFile",componentId:"sc-48xrf2-0"})(["opacity:0;height:0px;width:0px;z-index:-1;&:focus + label{box-shadow:var(--shadow-focus);outline:none;}"]),he=a().label.withConfig({displayName:"file-uploader__StyledFileUploaderLabel",componentId:"sc-48xrf2-1"})(["display:flex;gap:var(--spacing-s);user-select:none;color:",";font-size:var(--text-size-m);width:max-content;height:var(--size-s);line-height:1.8;vertical-align:middle;padding:var(--spacing-zero) var(--spacing-m);border:var(--button-outline-border);border-color:var(--button-outline-border-color);box-sizing:border-box;border-radius:var(--border-radius-default);&:hover{cursor:",";",";}"],(e=>e.isDisabled?"var(--content-color-tertiary)":"var(--content-color-primary)"),(e=>e.isDisabled?"not-allowed":"pointer"),(e=>!e.isDisabled&&"border-color: var(--button-outline-hover-border-color)")),be=a()(ae.Z).withConfig({displayName:"file-uploader__FileUploaderContainer",componentId:"sc-48xrf2-2"})(["max-width:100%;"]),ge=a().div.withConfig({displayName:"file-uploader__StyledChip",componentId:"sc-48xrf2-3"})(["width:100%;span{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}"]);function ve(e){return(0,v.jsx)(se.VW,{children:(0,v.jsx)(me,(0,i.Z)({},e))})}function me(e){const{value:n,onReset:l,id:o,label:a,name:s,multiple:r,isDisabled:c,loading:u,error:p,accept:h,autoFocus:b,onChange:g}=e,m=(0,d.Z)(e,ce),{addToast:f}=(0,se.ZP)();let y;if((0,t.useEffect)((()=>{p&&f({status:"error",title:ue,description:p})}),[p,f]),null!=n&&n.length){const e=n.length,i=n[0],t=n.join(", "),o=e>1?`${e} files selected`:`${i}`;y=(0,v.jsx)(U.Z,{content:t,children:(0,v.jsx)(ge,{children:(0,v.jsx)(re.Af,{label:o,onClick:l})})})}else y=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(pe,(0,i.Z)({},m,{id:o,onChange:e=>{const n=e.target,l=n&&n.files;!c&&l&&(null==g||g(l))},multiple:r,disabled:c,accept:h,name:s,autoFocus:b,onClick:e=>{e.currentTarget.value=""}})),(0,v.jsxs)(he,{htmlFor:o,isDisabled:c,children:[u&&(0,v.jsx)(de.Z,{size:"small"}),(0,v.jsx)("span",{children:a})]})]});return(0,v.jsx)(be,{direction:"column",alignItems:"center",children:y})}const fe=()=>{const e=(0,t.useRef)(!0);return(0,t.useEffect)((()=>()=>{e.current=!1}),[]),e},ye="Select Files",xe=a()(ae.Z).withConfig({displayName:"key-value-file-uploader__StyledContainer",componentId:"sc-1j9ub42-0"})(["padding:var(--spacing-xs);"]);function Ce(e){const{id:n,type:l,value:i,hidden:o,error:a,onFilesSelect:s,onChange:r}=e,[d,c]=(0,t.useState)(!1),u=fe(),p=(0,t.useMemo)((()=>Array.isArray(i)?i:i?[i]:[]),[i]);return o?null:(0,v.jsx)(xe,{height:"100%",width:"100%",children:(0,v.jsx)(ve,{label:ye,id:"key-value-file-uploader",multiple:!0,error:a,value:p,loading:d,onChange:e=>{s&&(c(!0),s(n,e).finally((()=>{u.current&&c(!1)})))},onReset:()=>null==r?void 0:r(l,"")})})}const we=e=>e.disableEdit,ke=(e,n)=>n||e.system&&!e.allowedToToggle,je=(e,n)=>!e.disableEdit&&!(null!=n&&n.disableToggle)||e.system;var Ve=l(70262),Se=l(95362);const Te=a().div.withConfig({displayName:"toggle-mask-button__IconContainer",componentId:"sc-pc7wmv-0"})(["padding:var(--spacing-xs) var(--spacing-s);border-radius:var(--border-radius-default);opacity:",";&:hover{cursor:pointer;}"],(({alwaysPresent:e})=>e?"1":"0"));function Ee({onClick:e,maskState:n,isVisible:l}){const i=!1===n.isMasked;return(0,v.jsx)(Te,{role:"button",className:"toggle-mask","aria-label":"toggle-mask-row",onClick:e,alwaysPresent:i||l,children:n.isMasked?(0,v.jsx)(Se.Z,{}):(0,v.jsx)(Ve.Z,{})})}var _e=l(64691),Re=l(48263),Ae=l(80605),De=l(30610),Ne=l(17282),We=l(29225);const Ze=e=>{const{onPersist:n,onReset:l,disableVariablePersistAction:i,disablePersistActionTooltip:t,disableResetActionTooltip:o,disableVariableResetAction:a}=e,s=(e=!1,n)=>{if(e){let e;switch(n){case"persist":e=t;break;case"reset":e=o}return e||"You do not have permissions to perform this action."}return null};return(0,v.jsxs)(_e.Z,{children:[(0,v.jsx)(Re.Z,{children:(0,v.jsx)(Ae.Z,{icon:(0,v.jsx)(We.Z,{size:"small"}),type:"tertiary",tooltip:"View more actions",size:"small","data-testid":"more-options-button"})}),(0,v.jsxs)(De.Z,{placement:"bottom-end",children:[(0,v.jsx)(Ne.Z,{onClick:n,isDisabled:i,tooltip:s(i,"persist"),children:"Persist"}),(0,v.jsx)(Ne.Z,{onClick:l,isDisabled:a,tooltip:s(a,"reset"),children:"Reset"})]})]})},Fe=a().div.withConfig({displayName:"key-value-row-actions-right__StyledActionsContainer",componentId:"sc-1hcb2h8-0"})(["display:flex;flex-direction:row;opacity:",";margin-right:var(--spacing-xs);"],(({isVisible:e})=>e?"1":"0")),Me=({isHidden:e=!1,children:n,isVisible:l})=>e||!n?null:(0,v.jsx)(Fe,{isVisible:l,children:n});var Ie=l(27363);const Pe=["warning"],ze=["prevValue","prevCurrentWidth"],Oe=["nextValue","nextCurrentWidth"],He=a().div.withConfig({displayName:"key-value-form-row__KeyValueFormRowContainer",componentId:"sc-3mzjb8-0"})(["display:flex;flex-direction:row;position:relative;flex:0;height:32px;border-bottom:var(--border-width-default) var(--border-style-solid) var(--border-color-default);background-color:",";color:",";"],(e=>e.isRowFocused?"var(--background-color-secondary) !important":e.isRowSelected||e.disabled?"var(--background-color-secondary)":"inherit"),(e=>e.disabled?"var(--content-color-tertiary)":"inherit")),Be=a().div.withConfig({displayName:"key-value-form-row__KeyValueRowInput",componentId:"sc-3mzjb8-1"})(["position:relative;display:flex;flex:1;min-width:0;flex-direction:row;color:",";"],(e=>e.isBlocked?"var(--content-color-tertiary)":"inherit")),Ke=a().div.withConfig({displayName:"key-value-form-row__StyledRowActionsContainer",componentId:"sc-3mzjb8-2"})(["display:flex;align-items:center;cursor:pointer;border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);"]),Le=a()(c.Z).withConfig({displayName:"key-value-form-row__StyledVariableTypeDropdown",componentId:"sc-3mzjb8-3"})([".aether-dropdown__control,.aether-dropdown__control--is-focused:hover{border:none;width:100%;box-shadow:none;background-color:unset !important;}"]),$e=new Map;$e.set("default",{value:B,label:"default"}),$e.set("secret",{value:H,label:"secret"});const Ue=[$e.get("default"),$e.get("secret")];function qe(e){const{index:n,value:l,onChange:o,onRemove:a,currentWidth:s,showColumns:r,allowedColumns:c,enableFiles:u,onFilesSelect:p,maskState:h,toggleMaskValue:b,isLastRow:g,onPersist:m,onReset:f,onBlur:x,enableVariableSuggestions:C,optionsDropdownValues:j,isDuplicated:V}=e,S=(0,t.useRef)(o);S.current=o;let{key:E,value:_,sessionValue:R="",options:A,type:D,enabled:N=!0,description:W="",fileUploadError:Z}=l;const F=D===H?H:B,M=r.includes("variableType")?F:D||"text",[I,P]=(0,t.useState)(null),[z,K]=(0,t.useState)(null),L=null!==I,$=(0,t.useMemo)((()=>{var e;return null!=(e=O.find((e=>e.value===l.type)))?e:O[0]}),[l.type]),U=(0,t.useCallback)(((e,n)=>{"sessionValue"===e&&void 0!==n&&l.isSessionValueDeleted&&(null==S.current||S.current((0,i.Z)({},l,{[e]:n,isSessionValueDeleted:!1}))),null==S.current||S.current((0,i.Z)({},l,{[e]:n}))}),[l]),q=(0,t.useCallback)((e=>{(0,d.Z)(l,Pe),U("enabled",e)}),[l,U]),X=(0,t.useCallback)((()=>{a&&a()}),[a]),Y=(0,t.useCallback)((n=>e[`nonEditable${k(n)}s`]),[e]);function J(e){return Number(s[null==r?void 0:r.indexOf(e)])}return(0,v.jsxs)(He,{role:"row","aria-rowindex":n,disabled:we(l),isRowSelected:e.isRowSelected,isRowFocused:null!==I,onMouseEnter:()=>K(!0),onMouseLeave:()=>K(!1),children:[(0,v.jsx)(y,{disabled:e.disableSorting&&e.nonEditableToggles,shouldShowCheckbox:je(l,e),isRowEnabled:N,onToggleEnabledState:q,isCheckboxDisabled:ke(l,e.nonEditableToggles)}),(0,v.jsxs)(Be,{isBlocked:l.disableEdit,children:[(0,v.jsx)(w,{columnWidth:J("key"),isNonEditable:Y("key"),isLastColumn:r&&"key"===r[r.length-1],content:(0,v.jsx)(G,{type:"key",value:E,currentWidth:J("key"),onFocus:()=>P("key"),onChange:U,isEditable:"key"===I,placeholder:e.keyPlaceholder,preventEnter:e.disableMultilineKey||!1,readOnly:l.disableEdit||e.nonEditableKeys,shouldFocusOnMount:!0,onBlur:()=>P(null),isDuplicated:V,actions:(0,v.jsx)(oe,{hidden:!z||!u,options:O,defaultOption:$,onChange:e=>U("type",e.value)}),indicators:(0,v.jsx)(ie,{infoTitle:l.infoTitle,info:l.info,placement:"right"}),enableVariableSuggestions:C})}),r.includes("variableType")&&(0,v.jsx)(w,{columnWidth:J("variableType"),isNonEditable:Y("variableType"),isLastColumn:r&&"variableType"===r[r.length-1],content:(!g||e.nonEditableVariableTypes)&&(0,v.jsx)(Le,{isRowFocused:L,tabIndex:-1,isDisabled:e.nonEditableVariableTypes,onChange:async l=>{const{disableAllVariablesSync:i=!1,disableSecretVariablesSync:t}=e;if(D===l.value)return;if(i||!t&&l.value===H||t&&l.value===H&&!_)return U("type",l.value),void(b&&b(n));const o=Ie.Modals.getModals(),a=await o.showWarningDialog({uid:"kv-editor-variable-type-change-confirmation",subject:`Change ${E}'s type to ${l.value}?`,message:"This will reveal the hidden values in plain text everywhere in the app for all team members",options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Change type",isPrimary:!0}]});return a&&"Change type"===a.title?(U("type",l.value),void(b&&b(n))):void 0},options:Ue,value:$e.get(M),isClearable:!1,isSearchable:!1,menuWidth:100})}),r.includes("value")&&(0,v.jsx)(w,{columnWidth:J("value"),isNonEditable:Y("value"),isLastColumn:r&&"value"===r[r.length-1],content:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(G,{hidden:"file"===D,type:"value",value:_,currentWidth:J("value"),onFocus:()=>P("value"),onChange:U,isEditable:"value"===I,placeholder:e.valuePlaceholder,preventEnter:e.disableMultilineValue||!1,readOnly:l.disableEdit||e.nonEditableValues,shouldFocusOnMount:!0,onBlur:()=>("value",P(null),void(x&&x("value",l))),editorType:D,maskState:h,enableVariableSuggestions:C}),(0,v.jsx)(Ce,{hidden:"file"!==D,id:n,type:"value",value:_,error:Z,onChange:U,onFilesSelect:p})]})}),r.includes("description")&&(0,v.jsx)(w,{columnWidth:J("description"),isNonEditable:Y("description"),isLastColumn:r&&"description"===r[r.length-1],content:(0,v.jsx)(G,{type:"description",value:W,onChange:U,placeholder:e.descriptionPlaceholder,isEditable:"description"===I,currentWidth:J("description"),onFocus:()=>P("description"),readOnly:l.disableEdit||e.nonEditableDescriptions,shouldFocusOnMount:!0,onBlur:()=>P(null)})}),r.includes("sessionValue")&&(0,v.jsx)(w,{columnWidth:J("sessionValue"),isNonEditable:Y("sessionValue"),isLastColumn:r&&"sessionValue"===r[r.length-1],content:(0,v.jsx)(G,{type:"sessionValue",value:R,onChange:U,isEditable:"sessionValue"===I,placeholder:l.isSessionValueDeleted?"[Deleted]":e.sessionValuePlaceholder,preventEnter:e.disableMultilineValue||!1,currentWidth:J("sessionValue"),onFocus:()=>P("sessionValue"),readOnly:l.disableEdit||e.nonEditableSessionValue,shouldFocusOnMount:!0,onBlur:()=>P(null),editorType:D,maskState:h,enableVariableSuggestions:C})}),r.includes("options")&&(0,v.jsx)(w,{columnWidth:J("options"),isNonEditable:Y("options"),isLastColumn:r&&"options"===r[r.length-1],content:(0,v.jsx)(Le,{isRowFocused:L,tabIndex:-1,onChange:e=>U("options",e),options:j,value:A,isClearable:!1,isSearchable:!1,menuWidth:100})}),(0,v.jsx)(Ke,{children:((null==r?void 0:r.includes("value"))||(null==r?void 0:r.includes("description"))||(null==r?void 0:r.includes("sessionValue")))&&!e.isRowSelected&&!e.value.disableEdit&&(0,v.jsxs)(v.Fragment,{children:[M===H&&(0,v.jsx)(Ee,{isVisible:z,maskState:h,onClick:()=>b(n)}),(0,v.jsxs)(Me,{isHidden:L,isVisible:z,children:[!e.disableDelete&&(0,v.jsx)(T,{onClick:X}),!e.disableVariableRowDropdown&&c.includes("sessionValue")&&(0,v.jsx)(Ze,{onPersist:m,onReset:f,disableVariablePersistAction:e.disableVariablePersistAction||e.disableSecretVariablesSync&&M===H,disablePersistActionTooltip:e.disablePersistActionTooltip,disableVariableResetAction:e.disableVariableResetAction||e.disableSecretVariablesSync&&M===H,disableResetActionTooltip:e.disableResetActionTooltip})]})]})})]})]})}const Xe=(0,t.memo)(qe,((e,n)=>{const{prevValue:l,prevCurrentWidth:i}=e,t=(0,d.Z)(e,ze),{nextValue:o,nextCurrentWidth:a}=n,s=(0,d.Z)(n,Oe);return!!p()(l,o)&&(!!p()(t,s)&&!!j(i,a))}));var Ye=l(49437),Ge=l(80047);const Je=["values","disableSorting","onChange","onRemove","disableDelete","disableCreate","disableToggle","keyPlaceholder","valuePlaceholder","descriptionPlaceholder","disableVariableRowDropdown","currentWidth","maskStatesMap","toggleMaskValue","onPersist","onReset","onBlur","filteredIndices","searchValue","enableScroll","duplicateWarningsMap"],Qe=a().div.withConfig({displayName:"key-value-form-sortable__KeyValueFormSortableContainer",componentId:"sc-1srvqog-0"})(["display:flex;flex:1;flex-direction:column;",";.key-value-form-editor-sortable__selectable{display:flex;flex-direction:column;}"],(({enableScroll:e})=>e&&"overflow: overlay;"));function en(e){let{values:n,disableSorting:l,onChange:o,onRemove:a,disableDelete:s,disableCreate:r,disableToggle:c,keyPlaceholder:u,valuePlaceholder:p,descriptionPlaceholder:h,disableVariableRowDropdown:b,currentWidth:g,maskStatesMap:m,toggleMaskValue:f,onPersist:y,onReset:x,onBlur:C,filteredIndices:w,searchValue:k,enableScroll:j,duplicateWarningsMap:V}=e,S=(0,d.Z)(e,Je);const T=(0,t.useCallback)(((e,n)=>{o&&o(e,n)}),[o]),E=(0,t.useCallback)((e=>{a&&a(e)}),[a]),_=k&&w?w.map((e=>n[e])):n;return(0,v.jsx)(Qe,{enableScroll:j,children:k&&0===_.length?(0,v.jsx)("div",{className:"key-value-form-editor-sortable",children:(0,v.jsx)(Ye.Z,{title:"No results found",children:(0,v.jsx)(Ge.Z,{name:"illustration-search"})})}):_&&_.map(((e,t)=>{var o,a,d;const w=e.id===(null==n?void 0:n.length)-1;return(0,v.jsx)(Xe,(0,i.Z)({index:null!=(o=e.id)?o:t,selectableKey:e.id,value:e,onChange:n=>T(e.id,n),onRemove:()=>E(e.id),onPersist:()=>{return n=e.id,void(y&&y(n));var n},onReset:()=>{return n=e.id,void(x&&x(n));var n},onBlur:(n,l)=>((e,n,l)=>{C&&C(e,n,l)})(e.id,n,l),disableSorting:l||w,disableToggle:c||w&&!r,disableDelete:s||w,disableVariableRowDropdown:b||w&&!r,keyPlaceholder:w&&u,valuePlaceholder:w&&p,descriptionPlaceholder:w&&h,isLastRow:w,currentWidth:g,maskState:!(!r&&w)&&(m&&m[e.id]||{isMasked:e.type===H}),isDuplicated:V&&V[e.id].isOverridden,toggleMaskValue:f},S),null!=(a=null==(d=e.id)?void 0:d.toString())?a:t)}))})}var nn=l(57569);function ln(e,n=100){return e/n*100}function tn(e,n=2){return Math.round(e*Math.pow(10,n))/Math.pow(10,n)}const on=500,an=a().div.withConfig({displayName:"resize-handle__StyledDiv",componentId:"sc-v0dm9s-0"})(["height:32px;width:16px;margin-left:-8px;background-color:transparent;position:absolute;left:","%;cursor:col-resize;z-index:1;"],(e=>e.left)),sn=e=>{const{showColumns:n,currentWidth:l,prevColumn:i,nextColumn:o,parentWidth:a=on,handleResize:s}=e,r=(0,t.useCallback)((e=>{const i=null==n?void 0:n.indexOf(e);if(-1===i)return 0;let t=0;for(let e=0;e<=i;e++)t+=l[e];return tn(t)}),[n,l]),d=(0,t.useMemo)((()=>{const e=r(n[(null==n?void 0:n.indexOf(i))-1])+ln(100,a),l=r(o)-ln(100,a);return{min:tn(e),max:tn(l)}}),[i,o,n,a,r]),c=(0,t.useCallback)((e=>Number.isNaN(d.min)||Number.isNaN(d.max)?e:tn(Math.min(Math.max(e,d.min),d.max))),[d]),u=(0,t.useCallback)(((e,t)=>{const r=c(ln(t.x,a));if(r==d.min||r==d.max)return;const u=[...l],p=l[n.indexOf(i)]+t.deltaX/a*100,h=l[n.indexOf(o)]-t.deltaX/a*100;u[null==n?void 0:n.indexOf(i)]=tn(p,2),u[null==n?void 0:n.indexOf(o)]=tn(h,2),null==s||s(u)}),[a,l,n,d]);return(0,v.jsx)(nn.DraggableCore,{onDrag:u,children:(0,v.jsx)(an,{left:c(r(i))})})},rn=a().div.withConfig({displayName:"key-value-header__KeyValueFormHeader",componentId:"sc-xo79cn-0"})(["font-size:var(--text-size-m);font-family:var(--font-family-default);"]),dn=a().div.withConfig({displayName:"key-value-header__StyledHeaderActionsContainer",componentId:"sc-xo79cn-1"})(["border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);display:flex;align-items:center;height:32px;padding:0 var(--spacing-xs);"]),cn=a().div.withConfig({displayName:"key-value-header__KeyValueFormHeaderRow",componentId:"sc-xo79cn-2"})(["display:flex;flex-direction:row;height:32px;position:relative;flex:1 1 auto;margin-bottom:var(--spacing-zero);border-bottom:var(--border-width-default) var(--border-style-solid) var(--border-color-default);&:hover,&.is-hovered{background-color:transparent;}&__is-highlighted{background-color:var(--background-color-info);animation:fadeOut 1.2s linear 1;.key-value-form-row__modification-options{background-color:var(--background-color-info);animation:fadeOut 1.2s linear 1;}}"]),un=a().div.withConfig({displayName:"key-value-header__KeyValueHeaderActions",componentId:"sc-xo79cn-3"})(["position:relative;display:flex;border-top-width:0;width:44px;justify-content:flex-end;border-left:var(--border-width-default) var(--border-style-solid) var(--border-color-default);border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);background-color:",";"],(e=>e.nonEditableToggles?"var(--background-color-secondary);":"inherit")),pn=a().div.withConfig({displayName:"key-value-header__FeedbackState",componentId:"sc-xo79cn-4"})(["height:30px;width:0;position:absolute;background-color:var(--border-color-default);"]),hn=a().div.withConfig({displayName:"key-value-header__HeadersGroup",componentId:"sc-xo79cn-5"})(["flex:1;flex-direction:row;position:relative;min-width:0;display:flex;"]),bn=a().div.withConfig({displayName:"key-value-header__HeaderContent",componentId:"sc-xo79cn-6"})(["padding:var(--spacing-s);color:var(--content-color-secondary);font-size:var(--text-size-m);line-height:var(--line-height-m);font-weight:var(--text-weight-medium);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:default;-webkit-user-select:none;user-select:none;"]),gn=a().div.withConfig({displayName:"key-value-header__HeaderColumn",componentId:"sc-xo79cn-7"})(["align-items:center;flex:",";overflow:hidden;display:flex;position:relative;box-sizing:border-box;border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);margin:var(--spacing-zero);background-color:",";"],(e=>e.isLastColumn?`0 1 ${e.columnWidth}%`:`0 0 ${e.columnWidth}%`),(e=>e.isNonEditable?"var(--background-color-secondary)":"inherit")),vn=new Map;vn.set("persistAll",{disabled:"You do not have permissions to perform this action.",default:"Persisting all values will replace all initial values with the current values of the variables."}),vn.set("resetAll",{default:"Resetting all values will replace all current values with the initial values of the variables."});const mn=(e,n,l)=>{let i;var t,o;return n&&(i=l||(null==(t=vn.get(e))?void 0:t.disabled)),i||(i=null==(o=vn.get(e))?void 0:o.default),i},fn=({allowedColumns:e,persistAll:n,disableVariablePersistAction:l,disablePersistActionTooltip:i,resetAll:t,disableVariableResetAction:o,disableResetActionTooltip:a})=>e.includes("sessionValue")?(0,v.jsx)(dn,{children:(0,v.jsxs)(_e.Z,{closeOnSelect:!1,children:[(0,v.jsx)(Re.Z,{"data-testid":"key-value-editor-more-actions-button",children:(0,v.jsx)(Ae.Z,{size:"small",icon:(0,v.jsx)(We.Z,{size:"small"}),type:"tertiary",tooltip:"View more actions","data-testid":"more-options-button-column-header"})}),(0,v.jsxs)(De.Z,{children:[(0,v.jsx)(Ne.Z,{onClick:n,isDisabled:l,tooltip:mn("persistAll",l,i),children:"Persist all"}),(0,v.jsx)(Ne.Z,{onClick:t,isDisabled:o,tooltip:mn("resetAll",o,a),children:"Reset all"})]})]})}):null;function yn(e){const{showColumns:n,currentWidth:l,handleWidthChange:i,keyHeading:o,valueHeading:a,descriptionHeading:s,sessionHeading:r,typeHeading:d,optionsHeading:c,allowedColumns:u,persistAll:p,resetAll:h,disableVariablePersistAction:b,disablePersistActionTooltip:g,disableVariableResetAction:m,disableResetActionTooltip:f}=e,y=(0,t.useRef)(null),[x,C]=(0,t.useState)(null);(0,t.useEffect)((()=>{const e=new ResizeObserver((e=>{C(e[0].contentRect.width)})),n=y.current;return e.observe(n),()=>{e.unobserve(n)}}),[]);const w=(0,t.useCallback)((n=>e[`nonEditable${k(n)}s`]),[e]),j=(0,t.useCallback)((e=>Number(l[null==n?void 0:n.indexOf(e)])),[n,l]);return(0,v.jsx)(rn,{role:"rowgroup",children:(0,v.jsxs)(cn,{role:"row",children:[(0,v.jsx)(un,{children:(0,v.jsx)(pn,{})}),(0,v.jsxs)(hn,{ref:y,children:[(0,v.jsx)(gn,{type:"key",role:"columnheader",columnWidth:j("key"),isNonEditable:w("key"),isLastColumn:n&&"key"===n[n.length-1],children:(0,v.jsx)(bn,{children:o||"Key"})}),(null==n?void 0:n.includes("variableType"))&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(sn,{handleResize:i,showColumns:n,currentWidth:l,prevColumn:"key",nextColumn:"variableType",parentWidth:x}),(0,v.jsx)(gn,{type:"variableType",role:"columnheader",columnWidth:j("variableType"),isNonEditable:w("variableType"),isLastColumn:n&&"variableType"===n[n.length-1],children:(0,v.jsx)(bn,{children:d||"Type"})})]}),(null==n?void 0:n.includes("value"))&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(sn,{handleResize:i,showColumns:n,currentWidth:l,prevColumn:n.includes("variableType")?"variableType":"key",nextColumn:"value",parentWidth:x}),(0,v.jsx)(gn,{type:"value",role:"columnheader",columnWidth:j("value"),isNonEditable:w("value"),isLastColumn:n&&"value"===n[n.length-1],children:(0,v.jsx)(bn,{children:a||"Value"})})]}),(null==n?void 0:n.includes("description"))&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(sn,{handleResize:i,showColumns:n,currentWidth:l,prevColumn:"value",nextColumn:"description",parentWidth:x}),(0,v.jsx)(gn,{type:"description",role:"columnheader",columnWidth:j("description"),isNonEditable:w("description"),isLastColumn:n&&"description"===n[n.length-1],children:(0,v.jsx)(bn,{children:s||"Description"})})]}),(null==n?void 0:n.includes("sessionValue"))&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(sn,{handleResize:i,showColumns:n,currentWidth:l,prevColumn:"value",nextColumn:"sessionValue",parentWidth:x}),(0,v.jsx)(gn,{type:"sessionValue",role:"columnheader",columnWidth:j("sessionValue"),isNonEditable:w("sessionValue"),isLastColumn:n&&"sessionValue"===n[n.length-1],children:(0,v.jsx)(bn,{children:r||"Current value"})})]}),u.includes("sessionValue")&&(0,v.jsx)(fn,{allowedColumns:u,persistAll:p,resetAll:h,disablePersistActionTooltip:g,disableResetActionTooltip:f,disableVariablePersistAction:b,disableVariableResetAction:m}),(null==n?void 0:n.includes("options"))&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(sn,{handleResize:i,showColumns:n,currentWidth:l,prevColumn:"value",nextColumn:"options",parentWidth:x}),(0,v.jsx)(gn,{type:"options",role:"columnheader",columnWidth:j("options"),isNonEditable:w("options"),isLastColumn:n&&"options"===n[n.length-1],children:(0,v.jsx)(bn,{children:c||"Options"})})]})]})]})})}const xn=["defaultValue","entityType","values","onChange","showColumns","nonEditableKeys","nonEditableValues","nonEditableDescriptions","nonEditableToggles","nonEditableOptions","keyHeading","valueHeading","sessionHeading","optionsHeading","optionsTooltip","nonEditableVariableTypes","hideBulkOptions","maskStatesMap","toggleMaskValue","initialColumnWidths","disableVariablePersistAction","disableVariableResetAction","disableSecretVariablesSync","disablePersistActionTooltip","disableResetActionTooltip","onDeleteRow","disallowDuplicates"],Cn=a().div.withConfig({displayName:"key-value-form-editor__StyledKeyValueFormEditor",componentId:"sc-quo1b1-0"})(["display:flex;flex:1;flex-direction:column;border-top:thin solid var(--border-color-default);min-height:0;"]);function wn(e){let{defaultValue:n="",entityType:l,values:o,onChange:a,showColumns:s,nonEditableKeys:r,nonEditableValues:c,nonEditableDescriptions:u,nonEditableToggles:p,nonEditableOptions:h,keyHeading:b,valueHeading:g,sessionHeading:m,optionsHeading:f,optionsTooltip:y,nonEditableVariableTypes:x,hideBulkOptions:C,maskStatesMap:w,toggleMaskValue:k,initialColumnWidths:j,disableVariablePersistAction:V,disableVariableResetAction:S,disableSecretVariablesSync:T,disablePersistActionTooltip:E,disableResetActionTooltip:_,onDeleteRow:R,disallowDuplicates:A}=e,D=(0,d.Z)(e,xn);const N={showColumns:s,allowedColumns:D.allowedColumns,nonEditableKeys:r,nonEditableValues:c,nonEditableDescriptions:u,nonEditableToggles:p,nonEditableOptions:h,hideBulkOptions:C},W=(0,t.useRef)(a);W.current=a;const[Z,F]=(0,t.useState)(function(e,n){let l;return n?l=n:(l=new Array(e.length).fill(Math.floor(100/e.length)),l[l.length-1]=l[l.length-1]+(100-l.reduce(((e,n)=>e+n)))),l}(s,j)),M=(0,t.useCallback)(((e,i={})=>{let t="text";"environment"!==l&&"globals"!==l||(t="default"),"collection"===l&&(t="string");const o={key:i.key||n,value:i.value||n,description:i.description||n,type:i.type||t,id:e};return D.allowedColumns.includes("sessionValue")&&(o.sessionValue=i.sessionValue||null),D.disableToggle||(o.enabled=!0),o}),[n,D.disableToggle,l,D.allowedColumns]),I=(0,t.useCallback)((()=>{if(o.length>0){var e=null==o?void 0:o.reduce((function(e,n){return e.id>=n.id?e:n}),{});return n=e,[Object,Array].includes((n||{}).constructor)&&0===Object.entries(n||{}).length?0:e.id+1}var n;return 0}),[o]),P=(0,t.useCallback)(((e,n)=>{const l=[...o],t=l.length===e?[...l,M(I(),n)]:l.map((l=>l.id===e?(0,i.Z)({},l,n):(0,i.Z)({},l)));null==W.current||W.current(t)}),[o,M,I]),z=(0,t.useCallback)((e=>{const n=[...o],l=null==n?void 0:n.filter(((n={})=>n.id!==e));R&&R(e),null==W.current||W.current(l)}),[o,R]),O=(0,v.jsx)(yn,(0,i.Z)({},N,{keyHeading:b||"Key",valueHeading:g||"Value",sessionHeading:m||"Current value",optionsHeading:f||"Options",optionsTooltip:y,nonEditableVariableTypes:x,handleWidthChange:F,currentWidth:Z,persistAll:()=>{if(V)return;let e=!1;const n=o.reduce(((n,l)=>{const t=l.enabled?l.sessionValue:l.value;return l.isSessionValueDeleted?(e=!0,n):(!e&&(e=!(T&&l.type===H)),T&&l.type===H?n.push(l):n.push((0,i.Z)({},l,{value:t})),n)}),[]);e&&(null==W.current||W.current(n))},resetAll:()=>{if(S)return;let e=!1;const n=o.map((n=>{const l=n.enabled?n.value:n.sessionValue;return T&&n.type===H?n:(e=!0,(0,i.Z)({},n,{sessionValue:l,isSessionValueDeleted:!1}))}));e&&(null==W.current||W.current(n))},disableVariablePersistAction:V,disableVariableResetAction:S,disablePersistActionTooltip:E,disableResetActionTooltip:_})),B=(0,t.useMemo)((()=>D.disableCreate?o:[...o,M(I())]),[o,D.disableCreate,M,I]),K=(0,t.useMemo)((()=>A?B.map(((e,n)=>{if(e.enabled&&""!==e.key)for(let l=n+1;l<B.length;l++){const n=B[l];if(e.key===n.key&&n.enabled&&""!==n.key)return(0,i.Z)({},e,{isOverridden:!0})}return(0,i.Z)({},e,{isOverridden:!1})})):null),[B,A]);return(0,v.jsxs)(Cn,{children:[o.length>0||!D.disableCreate?O:null,(0,v.jsx)(en,(0,i.Z)({},N,D,{nonEditableVariableTypes:x,values:B,onChange:P,onRemove:z,currentWidth:Z,maskStatesMap:w,toggleMaskValue:k,onPersist:e=>{if(V)return;let n=!1;const l=o.reduce(((l,t)=>{if(t.id===e){if(t.isSessionValueDeleted)return n=!0,l;T&&t.type===H?l.push(t):(n=!0,l.push((0,i.Z)({},t,{value:t.sessionValue})))}else l.push(t);return l}),[]);n&&(null==W.current||W.current(l))},onReset:e=>{if(S)return;let n=!1;const l=o.map((l=>l.id!==e||T&&l.type===H?l:(n=!0,(0,i.Z)({},l,{sessionValue:l.value,isSessionValueDeleted:!1}))));n&&(null==W.current||W.current(l))},onBlur:(e,n,l)=>{const t=o.findIndex((n=>n.id===e)),a=-1!==t&&o[t].sessionValue;let s;"value"===n&&-1!==t&&null===a&&l.value&&(s=[...o],s[t]=(0,i.Z)({},l,{sessionValue:l.value}),null==W.current||W.current(s))},disableVariablePersistAction:V,disableVariableResetAction:S,disableSecretVariablesSync:T,disablePersistActionTooltip:E,disableResetActionTooltip:_,duplicateWarningsMap:K}))]})}var kn=l(98529);const jn=E(((e,...n)=>e(...n)),100),Vn=({onSearchValueChange:e})=>{const[n,l]=(0,t.useState)("");return(0,v.jsx)("div",{className:"search-variable",children:(0,v.jsx)(kn.Z,{placeholder:"Filter variables",value:n,type:"search",onChange:n=>{l(n.target.value),jn(e,n.target.value)},onClear:()=>{l(""),e("")},prefix:!0,name:"filter-values"})})};function Sn(e,n){try{const l=(0,q.castNonStringTypesToString)(e),i=(0,q.castNonStringTypesToString)(n),t=l.toLowerCase(),o=i.toLowerCase();return t.indexOf(o)}catch(l){return console.error("PatterSearch~caseInsensitiveIndexof: Failed with error",l,e,n),-1}}const Tn=a().div.withConfig({displayName:"key-value-editor__KeyValueEditorContainer",componentId:"sc-f7ez8k-0"})(["padding-bottom:var(--spacing-s);display:flex;flex-direction:column;box-sizing:border-box;",";&.is-filterable{display:flex;flex-direction:column;}.search-variable{width:240px;padding-top:var(--spacing-xs);padding-bottom:var(--spacing-s);}"],(({enableScroll:e})=>e&&"height: 100%;")),En=(e,n)=>!n||!(!e.key||-1===Sn(e.key,n))||"secret"!==e.type&&(!(!e.value||-1===Sn(e.value,n))||!(!e.sessionValue||-1===Sn(e.sessionValue,n))||void 0),_n=(e,n)=>{if(!n)return null;const l=[];for(const[i,t]of e.entries())En(t,n)&&l.push(i);return l},Rn=(0,r.observer)((function(e){const{values:n,onChange:l,tableName:o,disallowDuplicates:a,allowedColumns:r,showColumns:d,onColumnToggle:c,keyPlaceholder:u,valuePlaceholder:p,maskStatesMap:h,toggleMaskValue:b,initialColumnWidths:g,enableFiltering:m=!1,enableScroll:f,isDirty:y=!1}=e,[x,C]=(0,t.useState)([]),[w,k]=(0,t.useState)(""),[j,V]=(0,t.useState)(null),S=(0,t.useRef)(y),T=(0,t.useCallback)((e=>{if(0===x.length)return!0;e.preventDefault();const i=null==n?void 0:n.filter(((e,n)=>!(null!=x&&x.includes(n))));x.sort(),0!==x[0]&&(x.length,n.length),C([]),l(i)}),[n,l,x]),E=(0,t.useCallback)((()=>{x.length>0&&C([])}),[x]),_=(0,t.useMemo)((()=>{let e=0;return(0,s.computed)((()=>null==n?void 0:n.map((n=>(0,i.Z)({},n,{id:e++})))))}),[n]).get();return(0,t.useEffect)((()=>{const e=_n(_,w);V(e)}),[w]),(0,t.useEffect)((()=>{if(S.current&&!y){const e=_n(_,w);V(e)}S.current=y}),[y]),(0,v.jsxs)(Tn,{role:"table","aria-label":o,enableScroll:f,children:[m&&(0,v.jsx)(Vn,{onSearchValueChange:k}),(0,v.jsx)(wn,(0,i.Z)({},e,{disallowDuplicates:a,onChange:l,values:_,selectedRows:x,deleteSelectedRows:T,onBeforeInput:E,allowedColumns:r,showColumns:d,onColumnToggle:c,keyPlaceholder:void 0!==u?u:"Key",valuePlaceholder:void 0!==p?p:"Value",descriptionPlaceholder:"Description",maskStatesMap:h,toggleMaskValue:b,initialColumnWidths:g,filteredIndices:j,searchValue:w,onDeleteRow:e=>{if(!w)return;const n=((e,n)=>{const l=[],i=new Set(n);let t=0;for(const n of e)i.has(n)?t++:l.push(n-t);return l})(j,[e]);V(n)}})),(0,v.jsx)(Ie.Modals.Ui.ModalDialog,{uid:"kv-editor-variable-type-change-confirmation"})]})})),An=e=>(0,v.jsx)(Rn,(0,i.Z)({},e))}}]);
//# sourceMappingURL=7623.0d62ec21776eba91.js.map